0) SCP Magics to/from cluster:

	// jar to cluster
	cd /Users/rruiz-at-work/Various & Sundry/appteon/dol-wioa-wpma/target/scala-2.11
	scp -i /Users/rruiz-at-work/Certs/DoL/ruiz.richard.p-AT-wips-dev-n-test.pem wioa-wpma-report_2.11-1.0.0.jar ruiz.richard.p@wipsdev.appteon.net:~/.

	// all query files to cluster
	cd /Users/rruiz-at-work/Various & Sundry/appteon/dol-wioa-wpma/src/main/resources
	scp -i /Users/rruiz-at-work/Certs/DoL/ruiz.richard.p-AT-wips-dev-n-test.pem queries* ruiz.richard.p@wipsdev.appteon.net:~/.

    // all input files to cluster
    cd /Users/rruiz-at-work/Various & Sundry/appteon/dol-wioa-wpma/src/main/resources
    scp -i /Users/rruiz-at-work/Certs/DoL/ruiz.richard.p-AT-wips-dev-n-test.pem input* ruiz.richard.p@wipsdev.appteon.net:~/.

	// GET results files
	cd /Users/rruiz-at-work/Various & Sundry/appteon/dol-wioa-wpma
	scp -i /Users/rruiz-at-work/Certs/DoL/ruiz.richard.p-AT-wips-dev-n-test.pem  ruiz.richard.p@wipsdev.appteon.net:~/results* .

1) SSH to cluster:

	ssh -i /Users/rruiz-at-work/Certs/DoL/ruiz.richard.p-AT-wips-dev-n-test.pem ruiz.richard.p@wipsdev.appteon.net

2) get mysql jar on cluster
	
	wget -O mysql.jar http://central.maven.org/maven2/mysql/mysql-connector-java/6.0.4/mysql-connector-java-6.0.4.jar

3) Spark Submit:


    // run-type=ad-hoc
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://wips-dev-redshift-ready/spra/12/1M-Rows.csv.gz s3-output=s3://ricks-foo-bucket/wioa-wpma/results local-output=true verbose=true debugging=true use-cached-cohorts=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv quarter-id=13 run-type=ad-hoc ad-hoc-args=f4,f10,f11 queries=/home/ruiz.richard.p/queries.json abbreviations=/home/ruiz.richard.p/queries-abbreviations.txt expected-results=/home/ruiz.richard.p/queries-expected-results-national.txt subsets=/home/ruiz.richard.p/queries-subsets.txt show-hits=false show-misses=true show-missing=true interactive=true load-cohorts-and-measures=false

    // aggregate-by=national
    // local-output=true
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://ricks-foo-bucket/wioa-wpma/input-preprocessed-and-doctored-5.parquet s3-output=s3://ricks-foo-bucket/wioa-wpma/results verbose=true debugging=true use-cached-cohorts=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv quarter-id=13 queries=/home/ruiz.richard.p/queries.json abbreviations=/home/ruiz.richard.p/queries-abbreviations.txt expected-results=/home/ruiz.richard.p/queries-expected-results-both.txt subsets=/home/ruiz.richard.p/queries-subsets.txt show-hits=false show-misses=true show-missing=true interactive=true sql-max-rows=25 load-cohorts-and-measures=true input-preprocessed=true driver-only=true local-output=true run-both-aggregations=false load-subsets-dynamically=false subsets-name=p3000 do-p1007-kludge=false aggregate-by=national

    // aggregate-by=subsets
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://ricks-foo-bucket/wioa-wpma/input-preprocessed-and-doctored-5.parquet s3-output=s3://ricks-foo-bucket/wioa-wpma/results verbose=true debugging=true use-cached-cohorts=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv quarter-id=13 queries=/home/ruiz.richard.p/queries.json abbreviations=/home/ruiz.richard.p/queries-abbreviations.txt expected-results=/home/ruiz.richard.p/queries-expected-results-both.txt subsets=/home/ruiz.richard.p/queries-subsets.txt show-hits=false show-misses=true show-missing=true interactive=true sql-max-rows=25 load-cohorts-and-measures=true input-preprocessed=true driver-only=true local-output=true run-both-aggregations=false load-subsets-dynamically=false subsets-name=p3000 do-p1007-kludge=false aggregate-by=subsets

    // subsets report, using doctored parquet file
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://ricks-foo-bucket/wioa-wpma/input-preprocessed-and-doctored-5.parquet s3-output=s3://ricks-foo-bucket/wioa-wpma/results verbose=true debugging=true use-cached-cohorts=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv quarter-id=13 queries=/home/ruiz.richard.p/queries.json abbreviations=/home/ruiz.richard.p/queries-abbreviations.txt expected-results=/home/ruiz.richard.p/queries-expected-results-both.txt subsets=/home/ruiz.richard.p/queries-subsets.txt show-hits=false show-misses=true show-missing=true interactive=true sql-max-rows=25 load-cohorts-and-measures=true input-preprocessed=true driver-only=false local-output=true run-both-aggregations=false load-subsets dynamically=false subsets-name=p3000 do-p1007-kludge=false report-window=r4q aggregate-by=subsets partitions=64

    // test loading of b0rk3d raw data: p1007 Kludge
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://wips-dev-redshift-ready/spra/12/row-modulus-12..csv.gz s3-output=s3://ricks-foo-bucket/wioa-wpma/results verbose=true debugging=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv quarter-id=13 queries=/home/ruiz.richard.p/queries.json abbreviations=/home/ruiz.richard.p/queries-abbreviations.txt expected-results=/home/ruiz.richard.p/queries-expected-results-both.txt subsets=/home/ruiz.richard.p/queries-subsets.txt show-hits=false show-misses=true show-missing=true interactive=true sql-max-rows=25 load-cohorts-and-measures=true input-preprocessed=false driver-only=true local-output=true run-both-aggregations=true load-subsets-dynamically=false subsets-name=p3000 do-p1007-kludge=true use-cached-cohorts=false load-cohorts-and-measures=true report-window=cq

    // production mode example: debugging is false by default
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://ricks-foo-bucket/wioa-wpma/input-preprocessed-and-doctored-5.csv input-preprocessed=true s3-output=s3://ricks-foo-bucket/wioa-wpma/results local-output=true subsets-name=p3000 do-p1007-kludge=true report-window=r4q

    // production mode for 19M rows of q13 data, minimalist "local-output=true" write to local file too
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://wips-dev-redshift-ready/spra/13/row-modulus-19.csv.gz s3-output=s3://ricks-foo-bucket/wioa-wpma/results quarter-id=13 report-window=r4q debugging=true

    // production mode for 1/19 of q13 data, minimalist "local-output=true" write to local file too, w/ quick startup
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://wips-dev-redshift-ready/spra/13/row-modulus-19.csv.gz s3-output=s3://ricks-foo-bucket/wioa-wpma/results quarter-id=13 report-window=r4q debugging=true aggregate-by=subsets run-both-aggregations=false load-subsets-dynamically=false use-cached-cohorts=true load-cohorts-and-measures=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv

    // production load: 19M rows, subsets only w/ quick start: 10m to load (gzipped), 10m to run
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://wips-dev-redshift-ready/spra/13/WIOAPerformanceRecords_PY2018Q1_FULL.csv.gz s3-output=s3://ricks-foo-bucket/wioa-wpma/results quarter-id=13 report-window=r4q debugging=true aggregate-by=subsets run-both-aggregations=false load-subsets-dynamically=false use-cached-cohorts=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv interactive=true

    // production load: 19M rows, subsets only q/ quick start using uncompressed csv + partitions switch: runs 19M in 4.7m!  4x faster :-)
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://wips-dev-redshift-ready/spra/13/allrows s3-output=s3://ricks-foo-bucket/wioa-wpma/results quarter-id=13 report-window=r4q debugging=true aggregate-by=subsets run-both-aggregations=false load-subsets-dynamically=false use-cached-cohorts=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv interactive=true partitions=128

    // production load: 19M rows, subsets only q/ quick start using parquet 128: runs 19M in 3.37m!
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://ricks-foo-bucket/wioa-wpma/19M-repartitioned-128.parquet s3-output=s3://ricks-foo-bucket/wioa-wpma/results quarter-id=13 report-window=r4q debugging=true aggregate-by=subsets run-both-aggregations=false load-subsets-dynamically=false use-cached-cohorts=true cohorts=s3://ricks-foo-bucket/wioa-wpma/ReportCohorts.csv measures=s3://ricks-foo-bucket/wioa-wpma/ReportMeasures.csv interactive=false partitions=128

    // production mode for 19M rows of q13 data, minimal args required: 5, 6 used
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://ricks-foo-bucket/wioa-wpma/19M-repartitioned-128.parquet s3-output=s3://ricks-foo-bucket/wioa-wpma/results quarter-id=13 report-window=r4q partitions=128

    // production mode for 19M rows of q13 data, minimal args required: 5
    spark-submit --class gov.doleta.wips.WioaWpmaReport --jars mysql.jar wioa-wpma-report_2.11-1.0.0.jar input=s3://wips-dev-redshift-ready/spra/13/allrows s3-output=s3://ricks-foo-bucket/wioa-wpma/results quarter-id=13 report-window=r4q partitions=128



4) Tunneling recipes:

    Spark History:

        ssh -i /Users/rruiz-at-work/Certs/DoL/ruiz.richard.p-AT-wips-dev-n-test.pem -N -L 18080:localhost:18080 ruiz.richard.p@wipsdev.appteon.net

    Zeppelin

        ssh -i /Users/rruiz-at-work/Certs/DoL/ruiz.richard.p-AT-wips-dev-n-test.pem -N -L 8890:localhost:8890 ruiz.richard.p@wipsdev.appteon.net

5) Online SQL validator

    https://www.eversql.com/sql-syntax-check-validator/

6) Run sbt w/ options

    set scalacOptions in ThisBuild ++= Seq("-feature", "-deprecation")